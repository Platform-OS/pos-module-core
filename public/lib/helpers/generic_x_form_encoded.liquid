{% liquid
  assign parameters = '' | split: ','
  for pair in payload
    assign component = pair[0] | append: '={' | append: pair[0] | append: '}'
    assign parameters = parameters | add_to_array: component
  endfor
  if parameters.size > 0
    assign x_form_encoded = parameters | join: '&' | expand_url_template: payload
  else
    assign x_form_encoded = ''
  endif

  return x_form_encoded
%}

